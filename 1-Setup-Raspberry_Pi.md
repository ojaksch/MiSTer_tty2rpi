
Table of Contents  
[Hardware](#hardware)  
[Setting up the Raspberry Pi lazy](#setting-up-the-raspberry-pi-lazy)  
[Setting up the Raspberry Pi manual](#setting-up-the-raspberry-pi-manual)  
[The INI files](#the-ini-files)  
[Media](#media)  
[Commands](#commands)  
[Bugs and things to do](#bugs-and-things-still-to-do)  
[License](#license)  

---

# Hardware

You obviously need a Rasoberry Pi. This is descibed in it's own chapter.  
I'm using [this display](https://www.amazon.de/dp/B08R5MFN5P) (not an affiliate link) as it's BIG in size, using HMDI and sound and fits my idea of a Marquee display. 
*Any* HDMI display will do in principle, but you'll need to have and use appropriate media files then.

---

# Setting up the Raspberry Pi lazy

~~This short HowTo is for the lazy guys who aren't adventurers. Just [download this image](https://drive.google.com/drive/folders/1jEfDOJIkxnNSgx5FvXF2xUvo7-5Dww_1?usp=sharing), 
burn it onto your RPI's SD >= 4gb and feed it to your RPi. Done. Boooring! :stuck_out_tongue_winking_eye:  
After it's first boot a script is run which expand it's filesystem to the full size of your SD and reboots another time. After the second boot you should 
see the "tty2tft" logo some seconds later. SSH is enabled, the username is "tty2rpi" with passwort "1" (all without quotes).~~

Link and image are still working, but maintaining two paths isn't reliable. You'd better take a manageable learning curve with manual installing.

---

# Setting up the Raspberry Pi manual

In this HowTo for the Indiana Jones' of you, I assume that you are already familiar with setting up a Raspberry Pi.

Obviously you need a Raspberry Pi. Any model except the Pico will do, but remember that - even a RPi1 will
do a fine job - the faster the RPi is, the more responsive your experience will be.
From my personal experience a good minimum is the RPi2, better would be a RPi3. A good choice regarding
price/power a RPi 3A+

Download the **Raspberry Pi OS Lite** of your choice from https://www.raspberrypi.com/software/operating-systems/
The usual version is the 32-bit version of the RPi OS for *all* RPi board releases, but if you would like to go
the 64-bit way and you are using a RPi 3A+ or greater, grab the 64-bit RPi OS.  

**REMARK**  
I'm currently having an issue with VLC and the 64-bit RPi OS where the videos aren't played at full speed. Needs some investigating.

Setup a SD card with the downloaded image. Insert the SD into your RPi, connect all needed cables and devices
and boot up your RPi. Follow the instruction there and setup your user and password. For simplicity you can create a user **tty2rpi** (see also at end of this paragraph). 
Enable and setup WiFi if you want to use it.

Update your Raspberry Pi OS and install the following packages:

```
sudo apt install mc dos2unix rsync git bc inotify-tools netcat-openbsd flex bison p7zip-full readline-common ncurses-base xorg xserver-xorg-video-fbdev openbox imagemagick vlc ffmpeg feh
```

Disable avahi (optional):
```
sudo systemctl disable avahi-daemon.service avahi-daemon.socket
```

Enable SSH:
```
sudo systemctl enable ssh.service
```

Get and run the install/update script:
```
wget https://raw.githubusercontent.com/ojaksch/MiSTer_tty2rpi/main/update_tty2rpi.sh -O - | bash -
```
Files that will be created;
- /boot/cmdline.txt.example -- compare with your existing cmdline.txt. The only relevant change here is the parameter *quiet*)
- /boot/config.txt.example -- compare with and edit your existing config.txt. Changes are:
```
...
#dtoverlay=vc4-kms-v3d
...
[all]
disable_splash=1
boot_delay=0
```
- /etc/X11/xorg.conf.d/10-monitor.conf -- Monitor config to disable DPMS
- /etc/wpa_supplicant/wpa_supplicant.conf.example -- Example config for WiFi
- /tmp/home/tty2rpi/ -- User files that will be copied to the user you have created - this is "the engine"
- /usr/local/bin/ -- Needed and needful programs

Read on the next chapters for the media content and a readup of the INI fles. When done, just reboot your RPi and continue 
with [setting up the MiSTer](/2-Setup-MiSTer.md)

---

# The INI files

There are two INI files: **tty2rpi.ini** and **tty2rpi-user.ini** which are read and evaluated by 
the daemon in that order. tty2rpi-user.ini is overwriting values done by tty2rpi.ini  
tty2rpi.ini contains the system wide variables and definitions. Do not edit this file as it will be overwritten when doing an update!  
For your own favorite variables please use tty2rpi-user.ini and take over and edit the needed line 
from tty2rpi.ini. All useful variables are commented - see "# Userdata" in tty2rpi.ini

---

# Media

You can create and use your own media files or
[get all the Marquee pictures](https://www.progettosnaps.net/marquees/) from progetto-SNAPS (or search for MAME's *marquees.zip* - there are many similar projects providing HQ Marquee sized images) 
[and the Marquee videos](https://www.arcadepunks.com/marquees-digital-marquees-cab-2/#google_vignette) from Arcade Punks
and store them on you RPi's SD card, on your NAS or wherever you want, as long as they are accessable by the OS' file system. Don't forget to mount the file system 
if needed and set their destination variables in **$HOME/tty2rpi-user.ini**  
The default set in **tty2rpi.ini** is
```
PATHPIC="${HOME}/marquee-pictures"
PATHVID="${HOME}/marquee-videos"
```
for RPi's SD in your created user's home.

~~You'll find some additional media files in the folder *media_files_rpi* of this repository. Copy the pictures to your created PATHPIC and 
*MISTER-MENU.mp4* to PATHVID, but renamed to MENU.png and MENU.mp4 when you are setting up tty2rpi for MiSTer, otherwise, when setting up tty2rpi for 
MAME, copy *MAME-MENU.png* and *MAME-MENU.mp4* without renaming it.~~

Paths are now predefined and already filled with some files for easier setup. Don't forget to copy these files to another folder or mount point, if changed by you.

---

# Commands

The commands available on RPi's side are handled by the Daemon (tty2rpi.sh) itself and are flexible...just create a file with the name of the command plus 
the extension of ".sh" (e.g. **~/tty2rpi-scripts/CMDHELLO.sh**), set file's attribute to "executable" and copy/write your script into that file. That's easy, isn't it?

Send the command from your client through the defined TCP socket (e.g.
```
echo "CMDHELLO,1st_parameter,2nd_parameter" > /dev/tcp/IP-ADDRESS-OF-RPI/6666)
```
As you can see, (many) parameters are possible and a comma sign is used as separator. No spaces are allowed as they're also interpreted as separator.  
Have a look at the already existing scripts in **~/tty2rpi-scripts/** to get an idea.

Available commands:
| Command                         | Description                              |
| ------------------------------- |----------------------------------------- |
| CMDCOR,PARAM                    | Shows a video and/or picture named PARAM |
| CMDSHOWCPU                      | Shows CPU informations                   |
| CMDSHOWIPS                      | Shows RPi's IP address(es)               |
| CMDSHUTDOWN                     | Shutdown the RPi                         |

---

# Bugs and things still to do

- No bugs for now (Yikes!)

- Revise and publish the documentation for MAME

---

# License

![CC BY-NC-SA 4.0](by-nc-sa.eu.png)  
[Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)](https://creativecommons.org/licenses/by-nc-sa/4.0/)
